(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){},135:function(e,t,n){"use strict";n.r(t);var a,o=n(0),r=n.n(o),i=n(9),l=n.n(i),c=(n(99),n(24)),s=n(15),u=n(28),d=n(25),m=n(27),p=(n(100),n(171)),b=n(90),h=n(34),E=n(31),g=n(12),v=n(5),f=n(14),O=n(176),D=n(173),j="LOGIN_VRM/SET_TOKEN",y=Object(O.a)("LOGIN_VRM/SET_ISNTLOGIN"),S=Object(O.a)(j),N={islogin:!1,username:"",idUser:null,headerWithToken:{},login:"175.com.ua@gmail.com",pass:"Ww9TArkV!dndv53"},w=Object(D.a)((a={},Object(v.a)(a,y,function(e,t){t.payload;return N}),Object(v.a)(a,S,function(e,t){var n=t.payload;return Object(f.a)({},e,n)}),a),N),T=function(e){return e.loginVRM},M=n(174),A=n(167),R=r.a.createRef(),C=function(e){var t=e.onChangeLoginPass,n=e.isLogin,a=e.loginRequest;return n.islogin?null:r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(M.a,{autoFocus:!0,placeholder:"login or email:",onChange:function(e){var n=e.target.value;return t({login:n})},onKeyDown:function(e){13===e.keyCode&&R.current.focus()},value:n.login})),r.a.createElement("div",null,r.a.createElement(M.a,{inputRef:R,type:"password",placeholder:"password",onChange:function(e){var n=e.target.value;return t({pass:n})},onKeyDown:function(e){13===e.keyCode&&a(n)},value:n.pass})),r.a.createElement("div",null,r.a.createElement(A.a,{variant:"outlined",color:"secondary",onClick:function(){return a(n)}},"Login")))},L=function(e){var t=e.isLogin,n=e.logout;return t.islogin?r.a.createElement("div",null,r.a.createElement("div",null,"login as: ".concat(t.username)),r.a.createElement("div",null,r.a.createElement(A.a,{color:"secondary",onClick:function(){n()}},"Exit"))):null},x=n(66),I=n.n(x),_="INSTALLATIONS_VRM/SET_INSTALLATIONS",k=Object(O.a)(_),z=Object(D.a)(Object(v.a)({},k,function(e,t){var n=t.payload;return Object(f.a)({},n)}),{data:{success:!1}}),W=function(e){return e.installationsVRM},Y="INSTALLATIONS_OBJECT_DATA/SET_DATA",X=Object(O.a)(Y),H=Object(D.a)(Object(v.a)({},X,function(e,t){var n=t.payload;return Object(f.a)({},n)}),{}),B=function(e){return e.installationsObjectData},P=Object(O.a)("UPDATE_TIMER/SET_TIMER"),U=Object(D.a)(Object(v.a)({},P,function(e,t){return t.payload}),0),V=function(e){return e.updateTimer},G="https://vrmapi.victronenergy.com",q="/v2/auth/login";var J,Z,K=(J=function(e){return"".concat(G,"/v2/users/").concat(e,"/installations?extended=1")},Z=k,function(e,t,n){return function(a){I()({method:"get",url:J(e),headers:t}).then(function(e){a(Z(e)),a(n(e))},function(e){return console.log(e)})}});function F(e){return function(t){if(e.data&&e.data.records){var n={};return e.data.records.forEach(function(e){var t={siteName:e.name};e.extended.forEach(function(e){t[e.idDataAttribute||e.code]={name:e.description,value:e.formattedValue}}),n[e.idSite]=t}),t(X(n)),n}return null}}function $(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;return function(n){n(P(setTimeout(function(){n(P(setInterval(function(){e.islogin&&(console.log("=== auto request ==="),n(K(e.idUser,e.headerWithToken,F)))},t)))},t)))}}var Q=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onChangeLoginPass,n=e.isLogin,a=e.logout,o=e.loginRequest;return r.a.createElement("div",{className:"login"},r.a.createElement(C,{onChangeLoginPass:t,isLogin:n,logout:a,loginRequest:o}),r.a.createElement("div",null,r.a.createElement(L,{isLogin:n,logout:a})))}}]),t}(r.a.Component),ee={onChangeLoginPass:S,logout:y,loginRequest:function(e){return function(t){I()({method:"post",url:G+q,data:'{"username": "'.concat(e.login,'", "password": "').concat(e.pass,'"}')}).then(function(n){if(200===n.status){var a={"X-Authorization":"Bearer "+n.data.token},o=n.data.idUser,r={islogin:!0,username:e.login,idUser:o,headerWithToken:a};t(S(r)),t(K(r.idUser,r.headerWithToken,F))}},function(e){return console.log(e),null})}}},te=Object(g.b)(function(e){return{isLogin:T(e)}},ee)(Q),ne=function(e){var t=new Date(1e3*e.last_timestamp),n=t.getFullYear(),a=t.getMonth()+1>9?t.getMonth()+1:"0"+(t.getMonth()+1),o=t.getDate()>9?t.getDate():"0"+t.getDate(),r=t.getHours()>9?t.getHours():"0"+t.getHours(),i=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return!0===e.alarm?"".concat(e.name," ( last connect: ").concat(r,":").concat(i," ").concat(o,".").concat(a,".").concat(n," ) !alarm!"):"".concat(e.name," ( last connect: ").concat(r,":").concat(i," ").concat(o,".").concat(a,".").concat(n," )")},ae=[143,215],oe=["consumption","solar_yield","from_to_grid"],re=function(e){var t=e.extended,n=t.filter(function(e){return-1!==ae.indexOf(e.idDataAttribute)}),a=t.filter(function(e){return-1!==oe.indexOf(e.code)}),o=n.concat(a);return r.a.createElement("div",{className:"small-site-data"},o.map(function(e){return r.a.createElement("div",{key:e.idDataAttribute||e.code},e.description," ",e.formattedValue)}))},ie=function(e){var t=e.site,n=e.selectInst,a=e.selectedInst;e.isLogin;return t.idSite===a?r.a.createElement("div",null,r.a.createElement(A.a,{color:"primary",disabled:!0},ne(t)),r.a.createElement(re,{extended:t.extended})):r.a.createElement("div",null,r.a.createElement(A.a,{color:"primary",onClick:function(){n(t.idSite)}},ne(t)))},le=function(e){var t=e.installationResponce,n=e.selectInst,a=e.selectedInst,o=e.isLogin;return t&&t.data.success?r.a.createElement("div",{className:"installation-menu"},t.data.records.map(function(e){return r.a.createElement("div",{key:e.idSite},r.a.createElement(ie,{site:e,selectInst:n,selectedInst:a,isLogin:o}))})):r.a.createElement("div",null,"Can`t receive installations list")},ce=Object(O.a)("SELECTED_INST/SET_INST"),se=Object(D.a)(Object(v.a)({},ce,function(e,t){return t.payload}),null),ue=function(e){return e.selectedInst},de=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.props.updateTimerId),clearTimeout(this.props.updateTimerId)}},{key:"componentWillMount",value:function(){this.props.updateInstallations(this.props.isLogin,2e4)}},{key:"render",value:function(){var e=this.props,t=e.isLogin,n=e.installationResponce,a=e.selectInst,o=e.selectedInst;return t.islogin?r.a.createElement("div",{className:"installations"},r.a.createElement(E.a,{push:!0,to:"/sites"}),r.a.createElement(le,{installationResponce:n,selectInst:a,selectedInst:o,isLogin:t})):r.a.createElement("div",{className:"inner-warning"},"Please login first!")}}]),t}(r.a.Component),me={selectInst:ce,setInstallations:k,setInstallationObjectData:X,updateInstallations:$},pe=Object(g.b)(function(e){return{isLogin:T(e),installationResponce:W(e),selectedInst:ue(e),updateTimerId:V(e)}},me)(de),be=n(169),he=n(170);function Ee(e){var t=e.dashboards,n=e.hide,a=e.toggleHide,o=e.setDashboardName,i=e.clearNewDashboard,l=e.clearWidgetSize;return n?r.a.createElement("div",{className:"main-menu-conteiner"},r.a.createElement(A.a,{variant:"outlined",color:"primary",className:"main-menu-button",onClick:a},"Menu")):r.a.createElement("div",{className:"main-menu-conteiner",onMouseLeave:a},r.a.createElement(A.a,{variant:"outlined",color:"primary",className:"main-menu-button",onClick:a},"Menu"),r.a.createElement("div",{className:"main-menu"},r.a.createElement(h.b,{to:"/sites",onClick:a},r.a.createElement("div",{className:"main-menu-base-elem"},"Go to main")),t.map(function(e,t){return e?r.a.createElement(h.b,{key:t,to:"/dashboards/?id=".concat(e.id),onClick:a},r.a.createElement("div",{className:"main-menu-elem"},e.name)):null}),r.a.createElement(h.b,{to:"/newdashboard",onClick:function(){a(),o("Dashboard #".concat(t.length)),i(),l()}},r.a.createElement("div",{className:"main-menu-base-elem"},"Create new dashboard"))))}var ge,ve=Object(O.a)("MOUSE_COORD/SET_COORD"),fe=Object(D.a)(Object(v.a)({},ve,function(e,t){var n=t.payload;return Object(f.a)({},e,n)}),{in:!0,X:0,Y:0,dragX:0,dragY:0}),Oe=function(e){return e.mouseCoordinates},De=n(172),je=n(175),ye=Object(O.a)("NEW_ELEMENT/SET_ELEMENT"),Se=Object(O.a)("NEW_ELEMENT/CLEAR_ELEMENT"),Ne={type:"param",idSite:"-",param:"-"},we=Object(D.a)((ge={},Object(v.a)(ge,ye,function(e,t){var n=t.payload;return Object(f.a)({},e,n)}),Object(v.a)(ge,Se,function(e,t){t.payload;return Ne}),ge),Ne),Te=function(e){return e.newDashboardElement},Me=n(61),Ae=n.n(Me),Re=n(59),Ce=n.n(Re),Le=n(60),xe=n.n(Le),Ie=n(168);function _e(e){var t=e.element,n=e.setMouseCoordinate,a=e.setNewElement,o=e.deleteElement,i=e.newDashboard,l=e.editElement,c=e.instDataObject,s=e.id;return t?r.a.createElement("div",{className:"constructor-element",style:{position:"absolute",left:t.X,top:t.Y},key:s,onMouseMove:function(e){n({X:e.clientX,Y:e.clientY-e.currentTarget.parentElement.getBoundingClientRect().top})}},r.a.createElement("div",{style:{cursor:"move"},className:"text-elem-dashboard-constructor-div",onMouseDown:function(e){0===e.button&&(n({dragX:e.clientX-e.currentTarget.getBoundingClientRect().left,dragY:e.clientY-e.currentTarget.getBoundingClientRect().top}),a(i[s].element),o(s))}},"".concat(t.element.name," : ").concat(t.element.value)),r.a.createElement("div",null,r.a.createElement(Ie.a,{className:"edit-elem-button",onClick:function(){var e=prompt("Monitor name:",t.element.name);e&&l({id:s,element:{name:e}})}},r.a.createElement(Ce.a,null))),r.a.createElement("div",null,r.a.createElement(Ie.a,{className:"info-elem-button",onClick:function(){alert("\n                    monitor name: ".concat(t.element.name,"\n                    site: ").concat(c[t.element.idSite].siteName,"\n                    parameter: ").concat(c[t.element.idSite][t.element.param].name,"\n                    value example: ").concat(c[t.element.idSite][t.element.param].value))}},r.a.createElement(xe.a,null))),r.a.createElement("div",null,r.a.createElement(Ie.a,{className:"delete-elem-button",onClick:function(){window.confirm("Do You want delete element?")&&o(s)}},r.a.createElement(Ae.a,null)))):null}function ke(e){var t=e.size,n=e.setTargetWidget,a=e.id,o=e.deleteElement,i=e.clearWidgetSize,l=e.children;return r.a.createElement("div",{className:"widget-outer-div",style:{position:"absolute",left:t.X,top:t.Y,width:"".concat(t.W,"px"),height:"".concat(t.H,"px"),borderWidth:"1px",borderStyle:"solid",borderColor:"rgb(0,0,0)"},onMouseEnter:function(e){n({id:a}),n(t)}},r.a.createElement("div",{className:"widget-content-div",style:{position:"absolute",left:0,top:"24px",backgroundColor:"#ffff",cursor:"crosshair"}},l),r.a.createElement("div",{className:"top-widget-div",style:{position:"absolute",right:0,top:"0px",height:"24px",width:"100%",cursor:"move"}}),r.a.createElement("div",{className:"bottom-right-corner-widget-div",style:{position:"absolute",right:"-5px",bottom:"-5px",height:"10px",width:"10px",cursor:"nwse-resize"}},r.a.createElement("div",{style:{position:"absolute",bottom:"50%",right:"50%",height:"5px",width:"5px",background:"linear-gradient(to bottom right, rgba(0,0,0,0) 50%, rgba(0,0,0,0) 5%, rgba(0,0,0,1) 45%"}})),r.a.createElement("div",{className:"widget-top-left-buttons-div",style:{position:"absolute",top:0,right:0,display:"flex",zIndex:1e3}},r.a.createElement("div",null,r.a.createElement(Ie.a,null,r.a.createElement(Ce.a,null))),r.a.createElement("div",null,r.a.createElement(Ie.a,null,r.a.createElement(xe.a,null))),r.a.createElement("div",null,r.a.createElement(Ie.a,{className:"delete-elem-button",onClick:function(){window.confirm("Do You want delete element?")&&(o(a),i())}},r.a.createElement(Ae.a,null)))))}function ze(e){var t=e.newDashboard,n=e.editElement,a=e.deleteElement,o=e.setMouseCoordinate,i=e.setNewElement,l=e.instDataObject,c=e.setTargetWidget,s=e.clearWidgetSize;return r.a.createElement("div",{className:"dashboard-in-constructor"},r.a.createElement("div",{className:"constructor-help-text",style:{disabled:!0}},r.a.createElement("p",null,"Choose site and parameter to add parameter element."),r.a.createElement("p",null,'Press "Add widget" button to add widget element.'),r.a.createElement("p",null,"To move parameter element hold mouse button and drag."),r.a.createElement("p",null,"To move widget element hold mouse button on top side and drag."),r.a.createElement("p",null,"To scale widget element use botoom and right side or bottom-right corner."),r.a.createElement("p",null,"Saved dashboards are in menu list.")),t.map(function(e,u){return e.delete?null:"widget"===e.element.type?r.a.createElement(ke,{key:u,id:u,setTargetWidget:c,size:e.element.size,deleteElement:a,clearWidgetSize:s},r.a.createElement("div",null,"Some content....")):r.a.createElement(_e,{element:e,setMouseCoordinate:o,setNewElement:i,deleteElement:a,newDashboard:t,editElement:n,instDataObject:l,id:u,key:u})}))}var We,Ye=n(21),Xe=Object(O.a)("NEW_DASHBOARD/SET_DASHBOARD_ELEMENT"),He=Object(O.a)("NEW_DASHBOARD/SET_DASHBOARD"),Be=Object(O.a)("NEW_DASHBOARD/EDIT_DASHBOARD_ELEMENT"),Pe=Object(O.a)("NEW_DASHBOARD/DELETE_DASHBOARD_ELEMENT"),Ue=Object(O.a)("NEW_DASHBOARD/CLEAR_DASHBOARD"),Ve=[],Ge=Object(D.a)((We={},Object(v.a)(We,Xe,function(e,t){var n=t.payload;return[].concat(Object(Ye.a)(e),[n])}),Object(v.a)(We,He,function(e,t){var n=t.payload;return Object(Ye.a)(n)}),Object(v.a)(We,Ue,function(e,t){t.payload;return Ve}),Object(v.a)(We,Be,function(e,t){var n=t.payload,a=Object(Ye.a)(e);return a[n.id].element=Object(f.a)({},e[n.id].element,n.element),a}),Object(v.a)(We,Pe,function(e,t){var n=t.payload,a=Object(Ye.a)(e);return a[n].delete=!0,a}),We),Ve),qe=function(e){return e.newDashboard};function Je(e){var t=e.newElement,n=e.coord,a=e.setToNewDashboard,o=e.clearElement,i=e.setMouseCoordinate;return n.in||n.dragX||n.dragY?n.Y<0?null:t===Ne?null:r.a.createElement("div",{className:"levitate-element-div",style:{position:"absolute",left:"".concat(n.X-n.dragX,"px"),top:"".concat(n.Y-n.dragY,"px")},onMouseUp:function(e){t.idSite!==Ne.idSite&&t.param!==Ne.param&&(a({element:t,X:n.X-n.dragX,Y:n.Y-n.dragY}),o()),i({dragX:0,dragY:0})}},t.name||"choose monitor"," : ",t.value||""):null}var Ze,Ke,Fe=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.setMouseCoordinate,n=e.coord,a=e.newElement,o=e.setToNewDashboard,i=e.clearElement;return r.a.createElement("div",{className:"constructor-field",style:{position:"absolute",top:"0",bottom:"0",width:"100%"},onMouseMove:function(e){t({in:!0,X:e.clientX-e.currentTarget.getBoundingClientRect().left,Y:e.clientY-e.currentTarget.getBoundingClientRect().top})},onMouseEnter:function(e){t({in:!0})},onMouseLeave:function(e){t({in:!1,X:e.clientX,Y:e.clientY-e.currentTarget.getBoundingClientRect().top})}},r.a.createElement(Je,{setMouseCoordinate:t,coord:n,newElement:a,setToNewDashboard:o,clearElement:i}))}}]),t}(r.a.Component),$e={setMouseCoordinate:ve,setToNewDashboard:Xe,clearElement:Se},Qe=Object(g.b)(function(e){return{coord:Oe(e),newElement:Te(e)}},$e)(Fe),et="currentWidgetSize",tt=Object(O.a)("CURRENT_WIDGET_SIZE/SET_SIZE"),nt=Object(O.a)("CURRENT_WIDGET_SIZE/CLEAR_SIZE"),at={X:-100,Y:0,W:50,H:50,resizeX:!1,resizeY:!1,move:!1},ot=Object(D.a)((Ze={},Object(v.a)(Ze,tt,function(e,t){var n=t.payload;return Object(f.a)({},e,n)}),Object(v.a)(Ze,nt,function(e,t){t.payload;return at}),Ze),at);function rt(e){var t=Object(g.c)(),n=Object(g.d)(function(e){return e[et]}),a=function(){t(Be({id:n.id,element:{size:{X:n.X,Y:n.Y,H:n.H,W:n.W}}}))};return r.a.createElement("div",{className:"widget-size-outer-div",style:{position:"absolute",left:n.X,top:n.Y,width:"".concat(n.W,"px"),height:"".concat(n.H,"px"),borderWidth:"1px",borderStyle:"solid",borderColor:"rgb(0,0,0)"}},e.children,r.a.createElement("div",{className:"top-move-div",style:{position:"absolute",right:0,top:n.move?"-50px":"0px",height:n.move?"100px":"24px",width:"100%",cursor:"move",zIndex:n.move?1001:999},onMouseMove:function(e){if(e.preventDefault(),n.move){var a=e.clientX-n.dX-n.left,o=e.clientY-n.dY-n.top;t(tt({X:a,Y:o}))}},onMouseDown:function(e){t(tt({move:!0,dX:e.clientX-e.currentTarget.parentElement.getBoundingClientRect().left,dY:e.clientY-e.currentTarget.parentElement.getBoundingClientRect().top}))},onMouseUp:function(e){t(tt({move:!1,dY:0,dX:0})),a()},onMouseLeave:function(e){t(tt({move:!1,dY:0,dX:0})),a()}},r.a.createElement("div",{className:"top-widget-div",style:{position:"absolute",top:n.move?"50%":0,width:"100%",height:"24px"}})),r.a.createElement("div",{className:"right-scale-div",style:{position:"absolute",right:n.resizeX?"-50px":"-5px",top:0,height:"100%",width:n.resizeX?"100px":"10px",cursor:"ew-resize"},onMouseMove:function(e){if(e.preventDefault(),n.resizeX){var a=e.clientX-e.currentTarget.parentElement.getBoundingClientRect().left;t(tt({W:a}))}},onMouseDown:function(e){t(tt({resizeX:!0}))},onMouseUp:function(e){t(tt({resizeX:!1})),a()},onMouseLeave:function(e){t(tt({resizeX:!1})),a()}}),r.a.createElement("div",{className:"bottom-scale-div",style:{position:"absolute",bottom:n.resizeY?"-50px":"-5px",height:n.resizeY?"100px":"10px",width:"100%",cursor:"ns-resize"},onMouseMove:function(e){if(e.preventDefault(),n.resizeY){var a=e.clientY-e.currentTarget.parentElement.getBoundingClientRect().top;t(tt({H:a}))}},onMouseDown:function(e){t(tt({resizeY:!0}))},onMouseUp:function(e){t(tt({resizeY:!1})),a()},onMouseLeave:function(e){t(tt({resizeY:!1})),a()}}),r.a.createElement("div",{className:"bottom-right-corner-scale-div",style:{position:"absolute",right:n.resizeY&&n.resizeX?"-50px":"-5px",bottom:n.resizeY&&n.resizeX?"-50px":"-5px",height:n.resizeY&&n.resizeX?"100px":"10px",width:n.resizeY&&n.resizeX?"100px":"10px",cursor:"nwse-resize"},onMouseMove:function(e){if(e.preventDefault(),n.resizeY&&n.resizeX){var a=e.clientX-e.currentTarget.parentElement.getBoundingClientRect().left,o=e.clientY-e.currentTarget.parentElement.getBoundingClientRect().top;t(tt({W:a,H:o}))}},onMouseDown:function(e){t(tt({resizeX:!0,resizeY:!0}))},onMouseUp:function(e){t(tt({resizeX:!1,resizeY:!1})),a()},onMouseLeave:function(e){t(tt({resizeX:!1,resizeY:!1})),a()}},r.a.createElement("div",{style:{position:"absolute",bottom:"50%",right:"50%",height:"5px",width:"5px",background:"linear-gradient(to bottom right, rgba(0,0,0,0) 50%, rgba(0,0,0,0) 5%, rgba(0,0,0,1) 45%"}})))}var it,lt=Object(O.a)("DASHBOARDS/SET_DASHBOARD"),ct=Object(O.a)("DASHBOARDS/LOAD_DASHBOARDS"),st=(Object(O.a)("DASHBOARDS/EDIT_DASHBOARD"),Object(O.a)("DASHBOARDS/DELETE_DASHBOARD")),ut=Object(D.a)((Ke={},Object(v.a)(Ke,lt,function(e,t){var n=t.payload,a=Object(Ye.a)(e);return a[n.id]=Object(f.a)({},n),a}),Object(v.a)(Ke,ct,function(e,t){var n=t.payload;return Object(Ye.a)(n)}),Object(v.a)(Ke,st,function(e,t){var n=t.payload,a=Object(Ye.a)(e);return a[n]="",a}),Ke),[]),dt=function(e){return e.dashboards},mt=Object(O.a)("DASHBOARD_NAME/SET_NAME"),pt=Object(O.a)("DASHBOARD_NAME/CLEAR_NAME"),bt=Object(D.a)((it={},Object(v.a)(it,mt,function(e,t){return t.payload}),Object(v.a)(it,pt,function(e,t){t.payload;return"newDashboard"}),it),"newDashboard"),ht=function(e){return e.dashboardName},Et=n(62),gt=n.n(Et);function vt(){return{element:{type:"widget",size:{X:0,Y:0,H:100,W:200}},X:0,Y:0}}var ft=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).upperDiv=Object(o.createRef)(),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.urlParam=gt.a.parse(this.props.location.search),this.urlParam.id&&this.props.dashboards[this.urlParam.id]?(this.urlParam.valid=!0,this.props.setNewDashboard(this.props.dashboards[this.urlParam.id].dashboard),this.props.setDashboardName(this.props.dashboards[this.urlParam.id].name)):(this.props.setDashboardName("Dashboard #".concat(this.props.dashboards.length)),this.props.clearNewDashboard())}},{key:"componentDidMount",value:function(){this.props.isLogin.islogin&&this.props.setWidgetSize({left:this.upperDiv.current.offsetLeft,top:this.upperDiv.current.offsetTop})}},{key:"componentDidUpdate",value:function(){this.props.isLogin.islogin&&this.props.setWidgetSize({left:this.upperDiv.current.offsetLeft,top:this.upperDiv.current.offsetTop})}},{key:"componentWillUnmount",value:function(){this.props.clearNewDashboard(),this.props.clearWidgetSize()}},{key:"render",value:function(){var e=this,t=this.props,n=t.setMouseCoordinate,a=t.isLogin,o=t.installationResponce,i=t.setNewElement,l=t.newElement,c=t.newDashboard,s=t.setToNewDashboard,u=t.editElement,d=t.deleteElement,m=t.setDashboard,p=t.dashboardName,b=t.setDashboardName,h=t.dashboards,E=t.instDataObject,g=t.setTargetWidget,v=t.clearWidgetSize;return a.islogin?r.a.createElement("div",{className:"constructor"},r.a.createElement("div",{className:"element-select-div",style:{width:"100%"}},o.data&&o.data.records?r.a.createElement(function(){return r.a.createElement(De.a,{native:!0,inputProps:{style:{width:"25"}},input:r.a.createElement(je.a,null),color:"primary",name:"site-select",value:l.idSite,onChange:function(e){var t=e.target.value;"-"!==t&&i({idSite:t})}},r.a.createElement("option",{key:"null",value:"-",hidden:!0},"Choose site"),o.data.records.map(function(e){return r.a.createElement("option",{key:e.idSite,value:e.idSite},e.name)}))},null):r.a.createElement("div",null,"Loading..."),o.data&&o.data.records?r.a.createElement(function(){return r.a.createElement(De.a,{native:!0,inputProps:{style:{width:"25"}},input:r.a.createElement(je.a,null),color:"primary",name:"param-select",value:l.param,onChange:function(e){var t=e.target.value;l.idSite!==Ne.idSite&&t!==Ne.param&&i({param:t,paramName:E[l.idSite][t].name,value:E[l.idSite][t].value,name:"".concat(E[l.idSite].siteName," ").concat(E[l.idSite][t].name)})}},r.a.createElement("option",{key:"null",value:"-",hidden:!0},l.idSite===Ne.idSite?"Choose site first":"Choose parameter"),function(e,t){var n=[];for(var a in e[t])n.push({id:a,name:e[t][a].name,value:e[t][a].value});return n}(E,l.idSite).map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))},null):null,r.a.createElement(je.a,{inputProps:{style:{width:"-webkit-fill-available"}},placeholder:"Edit parameter name",value:l.name||"",onChange:function(e){var t=e.target.value;i({name:t})}}),r.a.createElement(A.a,{variant:"outlined",color:"secondary",style:{marginLeft:"10px"},onClick:function(){s(new vt)}},"Add widget")),r.a.createElement("div",{ref:this.upperDiv,className:"constructor-box",id:"constructor-box",style:{position:"relative",height:"100vh"}},r.a.createElement(Qe,null),r.a.createElement(ze,{newDashboard:c,editElement:u,deleteElement:d,setMouseCoordinate:n,setNewElement:i,instDataObject:E,setTargetWidget:g,clearWidgetSize:v}),r.a.createElement(rt,null)),r.a.createElement("div",{style:{position:"fixed",left:"5px",bottom:"5px",zIndex:"100"}},r.a.createElement(M.a,{color:"primary",onChange:function(e){var t=e.target.value;return b(t)},value:p}),r.a.createElement(A.a,{onClick:function(){var t=c.filter(function(e){return!1===e.delete||void 0===e.delete});m({dashboard:t,name:p,id:e.urlParam.valid?e.urlParam.id:h.length}),alert('Dashboard "'.concat(p,'" saved. You can find it in main Menu.'))}},"Save dashboard"))):r.a.createElement("div",{className:"inner-warning"},"Please login first!")}}]),t}(r.a.Component),Ot={setMouseCoordinate:ve,setNewElement:ye,setToNewDashboard:Xe,editElement:Be,deleteElement:Pe,clearElement:Se,setDashboardName:mt,setDashboard:lt,clearNewDashboard:Ue,setNewDashboard:He,setWidgetSize:tt,setTargetWidget:tt,clearWidgetSize:nt},Dt=Object(g.b)(function(e){return{isLogin:T(e),installationResponce:W(e),newElement:Te(e),newDashboard:qe(e),dashboards:dt(e),dashboardName:ht(e),instDataObject:B(e)}},Ot)(ft),jt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.props.updateTimerId),clearTimeout(this.props.updateTimerId)}},{key:"componentWillMount",value:function(){this.props.updateInstallations(this.props.isLogin,1e4)}},{key:"render",value:function(){var e=this,t=this.props,n=t.dashboards,a=t.deleteDashboard,o=t.instDataObject,i=gt.a.parse(this.props.location.search);return i.id&&n[i.id]?r.a.createElement("div",{style:{position:"static"}},r.a.createElement("div",{className:"dashboard",style:{position:"relative"}},n[i.id].dashboard.map(function(e,t){return""===e?null:"widget"===e.element.type?r.a.createElement("div",{key:t,id:t,style:{position:"absolute",left:e.element.size.X,top:e.element.size.Y,height:e.element.size.H,width:e.element.size.W,borderColor:"rgba(0, 0, 0, 255)",borderWidth:"1px",borderStyle:"solid"}},r.a.createElement("div",null,"Some content....")):r.a.createElement("div",{key:t,style:{position:"absolute",left:e.X,top:e.Y}},"".concat(e.element.name," : \n                            ").concat(o[e.element.idSite]&&o[e.element.idSite][e.element.param]?o[e.element.idSite][e.element.param].value:"---"))})),r.a.createElement("div",{style:{position:"fixed",left:"5px",bottom:"5px"}},r.a.createElement(A.a,{onClick:function(){e.props.history.push("/newdashboard/?id=".concat(i.id))}},"Change dashboard"),r.a.createElement(A.a,{onClick:function(){window.confirm("Do you really want to delete dashboard?")&&(a(i.id),e.props.history.push("/"))}},"Delete dashboard"))):n.map(function(e,t){return e?r.a.createElement(h.b,{key:t,to:"/dashboards/?id=".concat(e.id)},r.a.createElement("div",null,e.name)):null})}}]),t}(r.a.Component),yt={setInstallations:k,deleteDashboard:st,setInstallationObjectData:X,updateInstallations:$},St=Object(g.b)(function(e){return{dashboards:dt(e),installationsResponce:W(e),isLogin:T(e),instDataObject:B(e),updateTimerId:V(e)}},yt)(jt),Nt=Object(O.a)("HIDE_MAIN_MENU/TOGGLE_MAIN_MENU"),wt=Object(D.a)(Object(v.a)({},Nt,function(e,t){t.payload;return!e}),!0),Tt=function(e){return e.hideMainMenu},Mt=Object(O.a)("READ_LOCAL_STORAGE/READ_LOCAL_STORAGE"),At=Object(b.a)({palette:{primary:be.a,secondary:he.a}}),Rt=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"404 Error: Page not found"),r.a.createElement(h.b,{to:"/sites"},"Go to main"))},Ct=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.readLocalStorage()}},{key:"render",value:function(){var e=this.props,t=e.dashboards,n=e.hideMainMenu,a=e.toggleHide,o=e.setDashboardName,i=e.clearNewDashboard,l=e.clearWidgetSize;return r.a.createElement(p.a,{theme:At},r.a.createElement("div",{style:{position:"fixed",top:"5px",right:"10px"}},r.a.createElement("h1",null,"PV monitor V1.0.0")),r.a.createElement("div",{className:"app"},r.a.createElement(h.a,{basename:"/PVM"},r.a.createElement("div",{className:"head"},r.a.createElement(Ee,{dashboards:t,toggleHide:a,hide:n,setDashboardName:o,clearNewDashboard:i,clearWidgetSize:l}),r.a.createElement(te,null)),r.a.createElement(E.d,null,r.a.createElement(E.b,{exact:!0,path:"/",component:pe}),r.a.createElement(E.b,{path:"/sites",component:pe}),r.a.createElement(E.b,{path:"/dashboards",component:St}),r.a.createElement(E.b,{path:"/newdashboard",component:Dt}),r.a.createElement(E.b,{component:Rt})))))}}]),t}(r.a.Component),Lt={setIsLogin:S,setInst:k,setDashboards:ct,toggleHide:Nt,setInstallationObjectData:X,setDashboardName:mt,clearNewDashboard:Ue,clearWidgetSize:nt,readLocalStorage:Mt},xt=Object(g.b)(function(e){return{dashboards:dt(e),hideMainMenu:Tt(e)}},Lt)(Ct);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var It,_t=n(46),kt={loginVRM:w,installationsVRM:z,selectedInst:se,installationsObjectData:H,mouseCoordinates:fe,newDashboardElement:we,newDashboard:Ge,dashboards:ut,dashboardName:bt,hideMainMenu:wt,currentWidgetSize:ot,updateTimer:U},zt=n(89);var Wt=(It={},Object(v.a)(It,"LOGIN_VRM/SET_ISNTLOGIN","loginVRM"),Object(v.a)(It,j,"loginVRM"),Object(v.a)(It,_,"installationsVRM"),Object(v.a)(It,Y,"installationsObjectData"),Object(v.a)(It,"DASHBOARDS/SET_DASHBOARD","dashboards"),It),Yt=[_,"LOGIN_VRM/SET_ISNTLOGIN",j,Y,"DASHBOARDS/SET_DASHBOARD"],Xt=function(e){return function(t){return function(n){var a,o,r=t(n),i=e.getState();return-1!==Yt.indexOf(n.type)&&(a=Wt[n.type],o=JSON.stringify(i[Wt[n.type]]),localStorage.setItem(a,o)),r}}},Ht=[{key:"loginVRM",Dispatch:S},{key:"installationsVRM",Dispatch:k},{key:"dashboards",Dispatch:ct},{key:"installationsObjectData",Dispatch:X}],Bt=function(e){return function(t){return function(n){var a=t(n);return"READ_LOCAL_STORAGE/READ_LOCAL_STORAGE"===n.type&&Ht.forEach(function(t){var n=function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):null}(t.key);n&&e.dispatch(t.Dispatch(n))}),a}}},Pt=function(){return[zt.a,Xt,Bt]};n.d(t,"store",function(){return Gt});var Ut,Vt,Gt=(Ut=kt,Vt=Pt(),Object(_t.d)(Object(_t.c)(Ut),{},_t.a.apply(void 0,Object(Ye.a)(Vt))));l.a.render(r.a.createElement(function(){return r.a.createElement(g.a,{store:Gt},r.a.createElement(xt,null))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},94:function(e,t,n){e.exports=n(135)},99:function(e,t,n){}},[[94,1,2]]]);
//# sourceMappingURL=main.c66ccdae.chunk.js.map